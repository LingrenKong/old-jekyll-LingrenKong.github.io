---
title: 组合数学知识（4）--母函数
mathjax: true
date: 2020-05-12 08:06:22
tags:
- 组合数学
categories:
- 学习
- 数学
- 组合数学
---

母函数（普通母函数与指数型母函数）

（组合数学课堂笔记等）

<!--more-->

# 一般母函数

一般母函数用基函数$\{1,x,x^2,\cdots\}$来定义

适合研究**组合**类型的递推数列



# 指数型母函数

研究**排列**的情况下，母函数使用的基是$\{1,x,x^2/2!,\cdots\}$

称作指数型是因为这组基是$e^x$的展开式
$$
e^{x}=\sum_{k=0}^{\infty} \frac{x^{k}}{k !}=1+x+\frac{x^{2}}{2 !}+\cdots+\frac{x^{k}}{k !}+\cdots
$$

$$
e^{ax}=\sum_{k=0}^{\infty} \frac{(ax)^{k}}{k !}=1+ax+a^2\frac{x^{2}}{2 !}+\cdots+a^k\frac{x^{k}}{k !}+\cdots
$$



指数型母函数：
$$
G_{e}(x)=a_{0}+a_{1} \frac{x}{1 !}+a_{2} \frac{x^{2}}{2 !}+\cdots+a_{k} \frac{x^{k}}{k !}+\cdots
$$
注意，在求解得到母函数之后，要对前面的系数做**还原**，乘上被除去的阶乘

比如：$b_4x^4 = a_4 \frac{x^4}{4!}$，所以我们求得是b，还不是目标a

指数型与排列：
$$
\begin{array}{l}
f_{e}(x)=A(n, 0)+A(n, 1) \frac{x}{1 !}+A(n, 2) \frac{x^{2}}{2 !}+\cdots+A(n, n) \frac{x^{n}}{n !} \\
=1+n x+\frac{n !}{2 !(n-2) !} x^{2}+\frac{n !}{3 !(n-3) !} x^{3}+\cdots+\frac{n !}{n ! 0 !} x^{n} \\
=(1+x)^{n}
\end{array}
$$
可见排列数类型的递推关系使用指数型母函数更合适，带有n的递推式一般也对应指数型的母函数。



常用公式：
$$
e^{x}=1+\frac{x}{1 !}+\frac{x^{2}}{2 !}+\frac{x^{3}}{3 !}+\cdots+\frac{x^{n}}{n !}+\cdots 
$$

$$
e^{-x}=1-\frac{x}{1 !}+\frac{x^{2}}{2 !}-\frac{x^{3}}{3 !}+\cdots+(-1)^{n} \frac{x^{n}}{n !}+\cdots
$$

$$
\frac{1}{2}\left(e^{x}-e^{-x}\right)=\frac{x}{1 !}+\frac{x^{3}}{3 !}+\cdots+\frac{x^{2 k+1}}{(2 k+1) !}+\cdots
$$

$$
\frac{1}{2}\left(e^{x}+e^{-x}\right)=1+\frac{x^{2}}{2 !}+\frac{x^{4}}{4 !}+\cdots+\frac{x^{2 k}}{(2 k) !}+\cdots
$$


## 经典例题

### 可重复排列数问题

如果是可重复全排列较为显然，但是可重复不全排列需要使用指数型母函数

对于**有限**可重复集合$\{a_1n_1, \cdots a_kn_k\}$:
$$
G_{e}(x)=\left(1+\frac{x}{1 !}+\frac{x^{2}}{2 !}+\cdots+\frac{x^{n_{1}}}{n_{1} !}\right) 
\left(1+\frac{x}{1 !}+\frac{x^{2}}{2 !}+\cdots+\frac{x^{n_{2}}}{n_{2} !}\right)\cdots
\left(1+\frac{x}{1 !}+\frac{x^{2}}{2 !}+\cdots+\frac{x^{n_{k}}}{n_{k} !}\right) 
$$
[注意直接求得的**不是**系数，需要**还原**那个对应的阶乘]

母函数的$p_k \frac{x^k}{k!}$那一项$p_k$就是从可重复集合中选取k个数排列的总方法数。

**无限**可重复集合的母函数只需要讲上述的$n_k$限制取出。



总结：

* 有限可重复：手动计算母函数
* 无限可重复：指数型母函数可以利用转换公式表示为指数函数进行运算，再把结果进行指数展开



### 完全错排问题

要求：把n个数进行排列，每个数$k$不在第$k$个位置上

递推方法：

* 第一类错排$(n-1)D_{n-2}$:选定前面一个位置i，和n交换（$a_i=n,a_n=i$）；剩余部分是n-2阶错排【这种情况下前面n-1个在交换前不构成错排，所以和第二类不同】
* 第二类错排$(n-1)D_{n-1}$：前面n-1个进行完全错排列，然后最后的n和前面任一交换

$D_n=(n-1)(D_{n-1}+D_{n-2})$

利用递推关系，整理出母函数的特性：
$$
G_e(x) = xG_e(x) + e^{-x} \\
G_{e}(x)=\frac{e^{-x}}{1-x}=\left(1-x+\frac{x^{2}}{2 !}-\cdots\right) /(1-x)
$$
计算得到：
$$
D_{n}=\left(1-1+\frac{1}{2 !}-\cdots + \frac{(-1)^n}{n !}\right) \cdot n !
$$
【注：完全错排问题还有更多的解法，比如容斥原理】

