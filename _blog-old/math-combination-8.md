---
title: 组合数学（8）-棋盘多项式
mathjax: true
date: 2020-05-26 07:59:35
tags:
- 组合数学
categories:
- 学习
- 数学
- 组合数学
---

棋盘多项式

<!--more-->

# 概念

棋盘布局问题：

设有一个棋盘C, 如果能把k个棋子布在棋盘上, 使得每行每列至多有一个棋子, 也就是说当一个棋子置于棋盘的某一格时, 这一格子所在的行和列都不能再布其他任何棋子. 这样的一个布局则称为棋盘C的一个k-布局, 用$r_k(C)$表示棋盘C不同k-布局的总数  

注意：

* 棋盘可以不规则！(残棋盘）
* 不存在k布局时$r_k(C)=0$，比如k比n大的时候
* 转置保持不变，所以默认棋盘$m\geq n$，行更多一些
* 约定$r_0(C)=1$，后面递推公式有用

# 例子

## 规则方棋盘

一个5*5棋盘

* 5布局相当于1-5的一个排列（一一对应）【$5!$】
* 1-4布局可以类似方法，转换成无重复排列

非方棋盘也可以同理转换

## 残棋盘

给定棋盘，布局数是可以求出的，但是通用方式是？



# 残棋盘的通解

## 关联矩阵

有格子为1，没有为0，得到一个矩阵$A(C)$，称其为棋盘C的关联矩阵

棋盘转换为矩阵，棋盘和关联矩阵唯一确定

## 共线

同一行列的元素称为共线，那么k布局就是关联矩阵不共线的k个1

## 棋盘多项式（母函数）

参考母函数的方法，给出棋盘多项式（棋盘问题的母函数）：
$$
R(C)= \sum_{k=0}^n r_k(C)x^k
$$
其中n是行列中小的那个（因为默认m大所以写成n）

对于棋盘C可以进行降阶操作，先设两个符号：

* 设$C_{ij}$表示将$(i,j)$位置所在行列都去掉的棋盘，对应的关联矩阵是原来矩阵的余子式
* 设$D_{ij}$表示将$(i,j)$位置本身去掉的棋盘，相当于将矩阵位置1改为0

那么问题可以拆分两类：

* 包含$(i,j)$格子的布局:$r_{k-1}(Cij)$
* 不包含$(i,j)$格子的布局$r_k(D_{ij})$

这样就得到了递推关系（利用了$r_0$定义）：
$$
R(C)= xR(C_{ij}) + R(D_{ij})
$$
注意：

* 这里的格子是**任意选取**的！选哪个都可以，只要是1就行，但是有的方法好
* 到比较低阶的时候可以符号有点乱（比如C只有一行进行降阶），但是依据定义还是可以求的
  * 棋盘有一整行列为0相当于没有那一行，可以降阶
  * 空棋盘可以当成一个0矩阵



## 基础的棋盘多项式

$$
R(1) = 1 + x \\
R(1;1)=1+2x
$$

注意利用转置不变性

利用递推式，最终可以将棋盘转换为基础的棋盘多项式（但是棋盘大的时候会比较复杂，需要计算机递归）

## 可分离的棋盘

两块没有共同的行列，关联矩阵是分块矩阵--那么可以当做两个棋盘分别求多项式，然后**相乘**



# 应用--禁位排列

错排问题是禁位排列的一种特殊情况，可以用容斥原理，但是如果是比较实际的情况，限制条件可能是复杂而且不对称的，此时可以用棋盘问题转化



## 直接求布局

【例】有四个老师，每人有些科目可以教，有些科目不会，要让他们把所有课完成，且一个人至多讲一节--转化棋盘，能教的是1，不能是0，所求方案数就是棋盘的布局数



## 容斥原理+棋盘

上面的棋盘格子一般会非常多，仍然不容易求解。

可以利用容斥原理，从全棋盘排除落点在禁位的方法

定理：设有n个棋子布入n×n的棋盘, 则有禁位的排列数为  
$$
Q_{n}=n !-r_{1} \times(n-1) !+r_{2} \times(n-2) !-\ldots 
+(-1)^{n-1} r_{n-1} \times 1 !+(-1)^{n} r_{n} \times 0 !
$$
其中$r_k$是有k个在禁区的布局数

**由于禁区一般是比较小的棋盘，所以求禁区的棋盘多项式更容易**（而且这个方法充分利用了多项式每一项，如果求有效位置多项式，实际只用了多项式一项）



禁区可能比较散，所以可以通过交换行列（不改变棋盘本质），得到比较紧密的几个块