---
title: 图论（5）网络最大流
mathjax: true
date: 2020-06-02 10:03:40
tags:
- 图论
categories:
- 学习
- 数学
- 图论
---

网络最大流问题

<!--more-->

# 概念

模型：源s（产地）-->转运站-->汇t（仓库）

容量网络：

* 网络上只有一个源一个汇
* 每条弧给出一个最大的通过能力--**容量**$c_{ij}$
* 除了源和汇，其余称为中间点

网络的最大流：从发点到收点允许通过的最大流量

流与可行流：

* 流：加在各条弧的实际流量（一个**函数**）
* 可行流：满足以下条件
  * $0 \leq f_{ij} \leq c_{ij}$
  * 中间点流入等于流出
  * 从源流出的等于从汇流入的
* 平凡流：$f=0$，零流



最大流可以看做是线性规划的问题，但是不适合用线性规划的方法，因为变量多且稀疏。



# 问题求解

基本思路是迭代法，找一个初始条件，终止条件是最大的判定，每次迭代是递增的

* 初始解：零流一定是可行流
* 最大化：最大流最小割定理
* 递增迭代：标号法



## 最大流最小割

割：将容量网络st分开，并且使得流中断的弧的集合。

割容量$c(K)$是割集合容量之和（只计算单向从s向t的容量，逆向的不计入）



定理：

* 定理一：流量$v(f)$满足$v(f)=f(V,V')-f(V',V)$,$(V,V')$是任意一个割集
* 推论1：流量一定小于等于割集的容量，$v(f)\leq c(V,V')$
* 用$f(V,V')\leq c(V,V')$放缩
* 推论2：最大流量$v^*(f)$不大于最小割集容量$c(V,V')$

这样对流的定义拓宽了，可以利用割集任意表示，而不是仅限于源点汇点



定理2：最大流等于最小割容量

源$s$，汇$t$，流为$f$，K为割，如果$v(f)=c(K)$，那么这就是最大流和最小割

## 调整方法

增广链：

* 从s到t的一条链，s到t方向称为前向弧，t到s称为后向弧
* 增广链**所有**前向弧的$f<c$，不饱和
* 增广链**所有**后向弧的$f>0$

定理3：最大流**当且仅当**不存在增广链

* 可以对增广链进行操作来增大流，所有前向弧+k，后向弧-k，从而使得部分弧不满足增广链条件
* 如果没有任何一个增广链，那么就找每个**链中饱和前向/零流后向**，这部分可以组成割集（流=割，就是最大流最小割）



完整的描述就是标号算法，从一个零流（或者某个增广链） 开始，不断的通过标号找增广链，然后对于增广链进行修正。



## 推广-多源多汇

仍然可以采用标号法--构造一个虚拟源&汇，虚拟源和所有源相连（真实源就变成了中间点），虚拟汇和所有汇相连（真实汇就变成了中间点）